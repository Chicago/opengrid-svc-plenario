//clean up first in case we're running this on a non-Travis CI box (transient)
db.opengrid_meta.remove({});
db.opengrid_users.remove({});
db.opengrid_data.remove({});

//make some test data
db.opengrid_meta.insert({ "datasets" : [{ "id" : "twitter", "displayName" : "Twitter", "options" : { "rendition" : { "icon" : "default", "color" : "#001F7A", "fillColor" : "#00FFFF", "opacity" : 85, "size" : 6 }, "creationTimestamp" : "date", "defaultSort" : "{'date':-1}" }, "dataSource" : { "sourceName" : "opengrid_data", "dbConnectionString" : "mongodb://build:test@localhost:27017/testdb?authSource=testdb", "baseFilter" : "{'type' : 'tweet'}" }, "quickSearch" : { "enable" : true, "triggerWord" : "tweet", "triggerAlias" : "twe" }, "columns" : [{ "id" : "_id", "displayName" : "ID", "dataType" : "string", "filter" : false, "popup" : false, "list" : false }, { "id" : "date", "displayName" : "Date", "dataType" : "date", "filter" : true, "popup" : true, "list" : true, "sortOrder" : 1 }, { "id" : "screenName", "displayName" : "Screen Name", "dataType" : "string", "filter" : true, "popup" : true, "list" : true, "sortOrder" : 2, "groupBy" : true, "quickSearch" : true }, { "id" : "text", "displayName" : "Text", "dataType" : "string", "filter" : true, "popup" : true, "list" : true, "sortOrder" : 3, "quickSearch" : true }, { "id" : "city", "displayName" : "City", "dataType" : "string", "filter" : true, "popup" : true, "list" : true, "sortOrder" : 4, "groupBy" : true, "quickSearch" : true }, { "id" : "bio", "displayName" : "Bio", "dataType" : "string", "sortOrder" : 5 }, { "id" : "hashtags", "displayName" : "Hashtags", "dataType" : "string", "sortOrder" : 6 }, { "id" : "lat", "displayName" : "Latitude", "dataType" : "float", "list" : true, "sortOrder" : 7 }, { "id" : "long", "displayName" : "Longitude", "dataType" : "float", "list" : true, "sortOrder" : 8 }] }, { "id" : "weather", "displayName" : "Weather", "options" : { "rendition" : { "icon" : "default", "color" : "#8c2d04", "fillColor" : "#fdae6b", "opacity" : 85, "size" : 6 }, "creationTimestamp" : "date", "defaultSort" : "{'date':-1}" }, "dataSource" : { "sourceName" : "opengrid_data", "dbConnectionString" : "mongodb://build:test@localhost:27017/testdb?authSource=testdb", "baseFilter" : "{'type' : 'weather'}" }, "quickSearch" : { "enable" : true, "triggerWord" : "weather", "triggerAlias" : "wea", "defaultMax" : 1, "defaultSort" : "{'date' : -1}" }, "columns" : [{ "id" : "_id", "displayName" : "ID", "dataType" : "string", "filter" : false, "popup" : false, "list" : false }, { "id" : "temp", "displayName" : "Temperature", "dataType" : "float", "filter" : true, "popup" : true, "list" : true, "sortOrder" : 1, "quickSearch" : true }, { "id" : "windspeed", "displayName" : "Wind Speed", "dataType" : "float", "filter" : true, "popup" : true, "list" : true, "sortOrder" : 2 }, { "id" : "condition", "displayName" : "Condition", "dataType" : "string", "filter" : true, "popup" : true, "list" : true, "sortOrder" : 3, "quickSearch" : true }, { "id" : "humidity", "displayName" : "Humidity", "dataType" : "float", "filter" : true, "popup" : true, "list" : true, "sortOrder" : 4 }, { "id" : "precipIntensity", "displayName" : "Precipitation Intensity", "dataType" : "float", "filter" : true, "popup" : true, "list" : true, "sortOrder" : 5 }, { "id" : "date", "displayName" : "Date", "dataType" : "date", "filter" : true, "popup" : true, "list" : true, "sortOrder" : 5 }, { "id" : "zipcode", "displayName" : "Zip Code", "dataType" : "string", "filter" : true, "popup" : true, "list" : true, "sortOrder" : 6, "groupBy" : true, "quickSearch" : true }, { "id" : "forecast", "displayName" : "Today's Forecast", "dataType" : "string", "popup" : true, "list" : true, "sortOrder" : 7 }, { "id" : "icon", "displayName" : "Icon", "dataType" : "graphic", "popup" : true, "sortOrder" : 7 }, { "id" : "lat", "displayName" : "Latitude", "dataType" : "float", "list" : true, "sortOrder" : 8 }, { "id" : "long", "displayName" : "Longitude", "dataType" : "float", "list" : true, "sortOrder" : 9 }] }, { "id" : "business_licenses", "displayName" : "Business Licenses", "options" : { "rendition" : { "icon" : "default", "color" : "#001F7A", "fillColor" : "#00FFFF", "opacity" : 85, "size" : 6 }, "latLong" : "where.latitude,where.longitude", "creationTimestamp" : "when.shardtime", "defaultSort" : "{'when.shardtime':-1}" }, "dataSource" : { "sourceName" : "business_licenses", "dbConnectionString" : "mongodb://build:test@localhost:27017/testdb?authSource=testdb" }, "quickSearch" : { "enable" : true, "triggerWord" : "license", "triggerAlias" : "lic", "defaultMax" : 10, "defaultSort" : "{'when.shardtime' : -1}" }, "columns" : [{ "id" : "_id", "displayName" : "ID", "dataType" : "string", "filter" : false, "popup" : false, "list" : false }, { "id" : "what.legal_name", "displayName" : "Legal Name", "dataType" : "string", "filter" : true, "popup" : true, "list" : true, "quickSearch" : true }, { "id" : "what.doing_business_as", "displayName" : "Doing Business As", "dataType" : "string", "filter" : true, "popup" : true, "list" : true, "quickSearch" : true }, { "id" : "where.address", "displayName" : "Address", "dataType" : "string", "filter" : true, "popup" : true, "list" : true, "quickSearch" : true }, { "id" : "what.lic_description", "displayName" : "Description", "dataType" : "string", "filter" : true, "popup" : true, "list" : true, "quickSearch" : true }, { "id" : "what.lic_status", "displayName" : "Status", "dataType" : "string", "filter" : true, "popup" : true, "list" : true, "quickSearch" : true, "groupBy" : true }, { "id" : "when.shardtime", "displayName" : "Issued Date", "dataType" : "date", "filter" : true, "popup" : true, "list" : true, "groupBy" : true }, { "id" : "when.expiration_date", "displayName" : "Expiration Date", "dataType" : "date", "filter" : true, "popup" : true, "list" : true, "groupBy" : true }, { "id" : "where.latitude", "displayName" : "Latitude", "dataType" : "float", "list" : true, "sortOrder" : 8 }, { "id" : "where.longitude", "displayName" : "Longitude", "dataType" : "float", "list" : true, "sortOrder" : 9 }] }, { "id" : "crimes", "displayName" : "Crimes", "options" : { "rendition" : { "icon" : "default", "color" : "#001F7A", "fillColor" : "#00FFFF", "opacity" : 85, "size" : 6 }, "latLong" : "where.latitude,where.longitude", "creationTimestamp" : "when.shardtime", "defaultSort" : "{'when.shardtime':-1}" }, "dataSource" : { "sourceName" : "crimes", "dbConnectionString" : "mongodb://build:test@localhost:27017/testdb?authSource=testdb" }, "quickSearch" : { "enable" : true, "triggerWord" : "crime", "triggerAlias" : "cri", "defaultMax" : 500, "defaultSort" : "{'when.shardtime' : -1}" }, "columns" : [{ "id" : "_id", "displayName" : "ID", "dataType" : "string", "filter" : false, "popup" : false, "list" : false }, { "id" : "where.address", "displayName" : "Address", "dataType" : "string", "filter" : true, "popup" : true, "list" : true, "quickSearch" : true }, { "id" : "when.shardtime", "displayName" : "Incident Date", "dataType" : "date", "filter" : true, "popup" : true, "list" : true, "groupBy" : true }, { "id" : "what.primary", "displayName" : "Primary", "dataType" : "string", "filter" : true, "popup" : true, "list" : true, "groupBy" : true }, { "id" : "what.description", "displayName" : "Description", "dataType" : "string", "filter" : true, "popup" : true, "list" : true, "quickSearch" : true }, { "id" : "what.curr_iucr", "displayName" : "Current IUCR", "dataType" : "string", "filter" : true, "list" : true }, { "id" : "when.curr_iucr_date", "displayName" : "Current IUCR Date", "dataType" : "date", "filter" : true, "list" : true }, { "id" : "what.status", "displayName" : "Status", "dataType" : "string", "filter" : true, "list" : true, "groupBy" : true, "popup" : true, "quickSearch" : true }, { "id" : "what.beat_asgn", "displayName" : "Beat", "dataType" : "string", "filter" : true, "list" : true, "groupBy" : true, "popup" : true, "quickSearch" : true }, { "id" : "where.latitude", "displayName" : "Latitude", "dataType" : "float", "list" : true, "sortOrder" : 8 }, { "id" : "where.longitude", "displayName" : "Longitude", "dataType" : "float", "list" : true, "sortOrder" : 9 }] }], "resourceSecurity" : [{ "urlPattern" : "^.*/rest/groups.*$", "httpMethod" : "GET", "requiredAuthorities" : "?" }, { "urlPattern" : "^.*/rest/groups.*$", "httpMethod" : "*", "requiredAuthorities" : "$admin" }, { "urlPattern" : "^.*/rest/users.*$", "httpMethod" : "GET", "requiredAuthorities" : "?" }, { "urlPattern" : "^.*/rest/users.*$", "httpMethod" : "*", "requiredAuthorities" : "$admin" }, { "urlPattern" : "^.*/rest/datasets/twitter.*$", "httpMethod" : "GET", "requiredAuthorities" : "twitter" }, { "urlPattern" : "^.*/rest/datasets/weather.*$", "httpMethod" : "GET", "requiredAuthorities" : "weather" }, { "urlPattern" : "^.*/rest/queries.*$", "httpMethod" : "*", "requiredAuthorities" : "?" }, { "urlPattern" : "^.*/rest/datasets/business_licenses.*$", "httpMethod" : "GET", "requiredAuthorities" : "business_licenses" }, { "urlPattern" : "^.*/rest/datasets/crimes.*$", "httpMethod" : "GET", "requiredAuthorities" : "crimes" }] });
db.opengrid_users.insert( { "userId" : "twitterUser", "password" : "password1", "firstName" : "Twitter", "lastName" : "User", "groups" : ["opengrid_users"] });
db.opengrid_data.insert( { "date" : 1336003040000, "type" : "tweet", "screenName" : "BearSuqqer", "text" : "@ThatsSoNuNu lol every body think that. But that's my Auntie", "city" : "dha chi", "bio" : "Junee 8thh. Aqee ___ . *Chicaqoo Illinois.TeamFollowBack , TeamFreaky", "lat" : 41.6786155, "long" : -87.6246676, "hashtags" : "" } );
db.opengrid_data.insert( { "date" : 1422531604796, "type" : "weather", "temp" : 35.55, "windspeed" : 4.86, "condition" : "Mostly Cloudy", "humidity" : 0.81, "precipIntensity" : 0, "zipcode" : "60632", "forecast" : "Snow (13 in.) throughout the week, with temperatures falling to 18F on Wednesday.", "icon" : "partly-cloudy-night", "lat" : 41.811709, "long" : -87.713644 } );
